**1. HIV示例**

在这里，我们将探索一个关于HIV感染患者在接受抗逆转录病毒药物治疗后的病毒载量（血液中病毒颗粒的数量）的模型。一个关于病毒载量的模型预测，在治疗开始后的时间为t时，血液中HIV的浓度 $V(t)$将是： 

$V(t)=A\exp(-\alpha t) + B\exp(-\beta t)$

参数 $A$, $\alpha$, $B$和 $\beta$是控制模型行为的常数。在这个实验中，你将使用到目前为止所学的Python知识来基于模型生成图表，导入和绘制实验数据，然后将模型参数拟合到数据上。

**1.1 探索模型**

首先使用
```python
time = np.linspace(0,1,11)
```
来产生一个时间序列。

接着用这个作为时间来查看血液中HIV浓度 $V(t)$的图像，可以先将 $B$设为0，$A, \alpha, \beta$选择你认为合理的值，然后用以下命令评估 $V(t)$：
```python
viral_load = A * np.exp(-alpha*time) + B * np.exp(-beta*time)
```

现在你应该有长度相同的两个数组，time和viral_load，所以绘制它们的图表： 
```python
plt.plot(time, viral_load)
```

使用不同的四个模型参数值查看不同的图像。

**1.2 拟合实验数据**

现在让我们看看一些实验数据。

从 http://www.physics.upenn.edu/biophys/PMLS/Datasets/ 获取数据集01HIVseries。将文件README.txt、HIVseries.csv和HIVseries.npz复制到你的工作目录。HIVseries文件包含时间序列数据。阅读文件README.txt了解详情。

将数据集导入Python，可以通过将HIVseries.csv读入数组或加载HIVseries.npz。（记住：函数np.load和np.loadtxt返回你请求的数据，但你必须将这些数据赋值给变量，以便稍后访问。）你可以给数据任何你喜欢的名字，但我们将数组称为hiv_data。

如果你使用np.loadtxt导入HIVseries.csv，数据将包含在一个单独的数组中。找到你在变量资源管理器中创建的变量。它包含两列数据。第一列是自HIV阳性患者接受治疗以来的天数；第二列包含该患者血液中病毒浓度的任意单位。

如果你使用np.load导入HIVseries.npz，数据将包含在一个不会出现在变量资源管理器中的对象中。（见3.2.2节。）你仍然可以检查它的内容。输入hiv_data.keys()来查找存储在内的数组的名称。有两个键，分别称为'time_in_days'和'viral_load'。你可以通过名称请求它们来检查相应的数组。你也可以将这些数组中的数据赋值给你选择的变量名：例如，concentration = hiv_data['viral_load']。

接下来，我们将对数据进行可视化。为了绘制病毒载量随时间变化的图表，你需要将数据分成两个数组传递给plt.plot。现在就做这个，然后绘制数据点。不要通过线段连接点。相反，使每个点成为一个符号，例如一个小圆圈或加号。标记你的图表的轴。也给它一个描述性的标题。

**作业：**

a. 在方程的函数图上叠加实验数据点。调整模型的四个参数，直到你在图表中可以看到数据和模型。 

现在的目标是调整关于 $V(t)$的方程的四个参数，直到模型与数据一致。在一个四维干草堆中找到正确的针是很难的！我们需要一种比仅仅猜测更系统的方法。考虑以下情况：假设β > α，长期行为的试验解是怎样的？如果数据也这样做，我们是否可以使用长期行为来确定四个未知常数中的两个，然后在调整另外两个时保持它们固定？

即使是两个常数也很难手动调整，所以让我们再想一想：初始值 $V(0)$如何依赖于四个常数参数？你能否以一种方式改变这些常数，始终给出正确的长期行为和初始值？

b. 进行这项分析，直到你只剩下一个自由参数，你可以相当容易地调整这个参数。调整这个参数，直到你喜欢你所看到的。

c. HIV的潜伏期大约是十年。根据你的结果，T细胞感染率的倒数1/α与潜伏期相比如何？

【备注：你可能知道有一些黑盒软件包可以自动进行这种“曲线拟合”。在这个实验中，你应该手动做，只是为了看看曲线如何响应参数的变化。】
